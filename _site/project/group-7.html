<!doctype html>

<html class="no-js" lang="en">

<head>


	<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

	ML with Ramin

	Personal Theme by https://jekyllthemes.io
	Premium + free Jekyll themes for your blog or website.

	- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->


	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

	<!-- Page Info -->
	<link rel="shortcut icon" href="/images/favicon.png">
	<title>Pneumonia Detection from Chest X-ray – ML with Ramin</title>
	<meta name="description" content="Apurva Nandgaonkar, Nita Chaudhary, Vinay Prabhu and Upendra Deshpande">

	<!-- Twitter Card -->
	<meta name="twitter:card" content="summary_large_image">
	<meta name="twitter:title" content="Pneumonia Detection from Chest X-ray – ML with Ramin">
	<meta name="twitter:description" content="Apurva Nandgaonkar, Nita Chaudhary, Vinay Prabhu and Upendra Deshpande">
	<meta name="twitter:image:src" content="http://localhost:4000/images/Projects/group_7/thumbnail.webp">

	<!-- Facebook OpenGraph -->
	<meta property="og:title" content="Pneumonia Detection from Chest X-ray – ML with Ramin" />
	<meta property="og:description" content="Apurva Nandgaonkar, Nita Chaudhary, Vinay Prabhu and Upendra Deshpande" />
	<meta property="og:image" content="http://localhost:4000/images/Projects/group_7/thumbnail.webp" />

	
	<!-- Font Embed Code -->
	<link href="https://fonts.googleapis.com/css?family=Muli:300,400,600,700" rel="stylesheet">
	

	<!-- Styles -->
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="/css/style.css">
	
	<!-- Icons -->
	<script defer src="https://use.fontawesome.com/releases/v5.1.1/js/solid.js" integrity="sha384-GXi56ipjsBwAe6v5X4xSrVNXGOmpdJYZEEh/0/GqJ3JTHsfDsF8v0YQvZCJYAiGu" crossorigin="anonymous"></script>
	<script defer src="https://use.fontawesome.com/releases/v5.1.1/js/brands.js" integrity="sha384-0inRy4HkP0hJ038ZyfQ4vLl+F4POKbqnaUB6ewmU4dWP0ki8Q27A0VFiVRIpscvL" crossorigin="anonymous"></script>
	<script defer src="https://use.fontawesome.com/releases/v5.1.1/js/fontawesome.js" integrity="sha384-NY6PHjYLP2f+gL3uaVfqUZImmw71ArL9+Roi9o+I4+RBqArA2CfW1sJ1wkABFfPe" crossorigin="anonymous"></script>

	
	<!-- Custom Styles -->
	<style></style>
	

	
	<!-- Analytics Code -->
	
	

	
	<!-- Extra Header JS Code -->
	
	
	
</head>


<body class="loading ajax-loading" data-site-url="http://localhost:4000" data-page-url="/project/group-7">


	<header class="header">

	<div class="wrap">

		
		<a href="/" class="header__title">
			ML with Ramin
		</a>
		

		<div class="menu">
			<div class="menu__toggle js-menu-toggle">
				<div class="menu__toggle__icon"><span></span></div>
			</div>
			<div class="menu__wrap">
				<ul class="menu__list">
					
					<li class="menu__list__item">
						<a href="/about/" class="menu__list__item__link">About us</a>
					</li>
					
					<li class="menu__list__item">
						<a href="/ml/" class="menu__list__item__link">Machine Learning</a>
					</li>
					
					<li class="menu__list__item">
						<a href="/mlops/" class="menu__list__item__link">MLOps</a>
					</li>
					
				</ul>
			</div>
		</div>

	</div>

</header>


	<div class="loader"><svg width="120" height="30" viewBox="0 0 120 30" xmlns="http://www.w3.org/2000/svg"><circle cx="15" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite" /><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite" /></circle><circle cx="60" cy="15" r="9" fill-opacity="0.3"><animate attributeName="r" from="9" to="9" begin="0s" dur="0.8s" values="9;15;9" calcMode="linear" repeatCount="indefinite" /><animate attributeName="fill-opacity" from="0.5" to="0.5" begin="0s" dur="0.8s" values=".5;1;.5" calcMode="linear" repeatCount="indefinite" /></circle><circle cx="105" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite" /><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite" /></circle></svg></div>

	<div class="page-loader"></div>

	
	<div class="page">

		<div class="page__content" data-page-title="Pneumonia Detection from Chest X-ray – ML with Ramin">

			<section class="hero hero--single">

	<div class="hero__image" style="background-image: url(/images/Projects/group_7/thumbnail.webp)">
		<div class="hero__overlay"></div>
	</div>

	<div class="wrap">

		<h1>Pneumonia Detection from Chest X-ray</h1>
		<p>Group-7</p>

	</div>

</section>

<section class="single">

	<div class="wrap">

		<article class="single-post">

			<table>
  <thead>
    <tr>
      <th>Team member</th>
      <th>Email</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Apurva Nandgaonkar</td>
      <td>nandgaonkar.ap@northeastern.edu</td>
    </tr>
    <tr>
      <td>Nita Chaudhary</td>
      <td>chaudhari.nit@northeastern.edu</td>
    </tr>
    <tr>
      <td>Vinay Prabhu</td>
      <td>prabhu.v@northeastern.edu</td>
    </tr>
    <tr>
      <td>Upendra Deshpande</td>
      <td>deshpande.u@northeastern.edu</td>
    </tr>
  </tbody>
</table>

<p>We have trained multiple classification models to detect pneumonia from chest X-rays.</p>

<h2 id="dataset">Dataset</h2>

<p>The dataset is divided into 3 parts namely training, validation and testing dataset each of them with two categories of images - Chest X-ray images with Pneumonia and Normal Chest X- ray images. 
<a href="https://www.kaggle.com/datasets/paultimothymooney/chest-xray-pneumonia">Dataset Link</a>
<br />
 </p>

<h2 id="methodology">Methodology</h2>

<h3 id="data-preprocessing">Data Preprocessing</h3>

<p>In the original dataset, all the images had different dimensions. 
We resized all the images to equal sizes and flattened to create new datasets on which classical ML models can be trained.</p>

<p>Dataset-1: All the images in dataset were resized to (256 × 256) pixels.
After flattening images to form an array and combining into a dataset, each row has 65536 (i.e. 256 × 256) dimensions.</p>

<p>Dataset-2: All the images in dataset were resized to (64 × 64) pixels.
After flattening images to form an array and combining into a dataset, each row has 4096 (i.e. 64 × 64) dimensions.</p>

<p>All the images were normalized in range of [0, 1].
<br />
 </p>

<h3 id="dimension-reduction">Dimension Reduction</h3>

<h4 id="pca">PCA</h4>

<p>PCA is a dimensionality reduction technique commonly used to reduce the dimensions of large datasets. The idea of PCA is to reduce the variables in the dataset and retain as much data as possible. PCA requires huge amounts of storage while working with many images. Also, it’s very hard to preprocess and visualize the larger datasets. By using PCA as a dimensionality reduction technique, this problem can be solved, and multidimensional data can be compressed in as less as a single column.
Explained variance is a statistical measure of how much variation in a dataset can be attributed to each of the principal components.</p>

<p><img src="/images/Projects/group_7/PCA1gif.gif" width="1000" /></p>

<p>We plotted number of features Versus variance captured in percentage on normalized Dataset 2.
As seen in the plot below, almost 95 percent of variance in the dataset is captured by 200 features.
We applied PCA to dimensionally reduce the Dataset-2 from 4096 features to 200 features.</p>

<p>Percent Variance captured Vs Number of Principal Components:</p>

<p><img src="/images/Projects/group_7/PCA2.webp" width="450" />
<br />
 </p>

<h4 id="autoencoder">Autoencoder</h4>

<p>AutoEncoder is an unsupervised Artificial Neural Network that attempts to encode the data by compressing it into the lower dimensions (latent layer) and then decoding the data to reconstruct the original input. The latent layer holds the compressed representation of the input data.
When using AutoEncoders for dimensionality reduction, the latent layer is extracted and used to reduce the dimensions. This process can be viewed as feature extraction.</p>

<p>We have used fully connected deep neural network with 65536 (i.e. 256 × 256) neurons in both input and output layer and 256 (i.e. 16 × 16) neurons in latent layer. We have used ReLU activation function for all layers except the output layer where we used sigmoid function as we need output to be in range of [0, 1].</p>

<p>Autoencoder Architecture:</p>

<p><img src="/images/Projects/group_7/Autoencoder1.webp" width="450" /></p>

<p>Reconstruction error versus number of epochs:</p>

<p><img src="/images/Projects/group_7/Autoencoder2.webp" alt="image" />
<br />
 </p>

<h3 id="machine-learning-models">Machine Learning Models</h3>

<h4 id="logistic-regression">Logistic Regression</h4>

<p>Logistic Regression is a classification method used to assign observations to a discrete set of classes. It is a supervised Machine Learning Algorithm used to predict the probability of a target variable. In case of binary logistic regression, the target variables must be binary always and the desired outcome is represented by the factor level 1.</p>

<p><img src="/images/Projects/group_7/LR1.webp" alt="image" /></p>

<p>While implementing the Logistic Regression algorithm, we considered 3 hyperparameters. The first one was ‘learning rate’ for gradient descent algorithm. Second was ‘tolerance’ value and third was the maximum ‘number of iterations’, both of these being the convergence conditions for gradient descent algorithm.
We tried different combinations of these hyperparameters to select the best training and test performance of the algorithm. 
<br />
 </p>

<h4 id="k-nearest-neighbours">K Nearest Neighbours</h4>

<p>K-nearest neighbors (KNN) is a type of supervised learning algorithm used for both regression and classification. KNN tries to predict the correct class for the test data by calculating the distance between the test data and all the training points. Then select the K number of points which is closet to the test data. The KNN algorithm calculates the probability of the test data belonging to the classes of ‘K’ training data and class holds the highest probability will be selected.</p>

<p>While implementing the KNN algorithm, we considered neighbours ranging from 5 to 200 with interval of 5 based on iterations. Assigned the new data points to that category for which the number of the neighbor was maximum. Thus we predicted whether disease was absent or present. 
We finalised the number of neighbours based on evaluation metrics to find out which was the optimal value of k. For our dataset, best value of k was 10.</p>

<p><img src="/images/Projects/group_7/KNN1gif.gif" alt="image" />
<br />
 </p>

<h4 id="svm">SVM</h4>

<p>The objective of the support vector machine algorithm is to find a ‘Optimal Separating Hyperplane(Decision Boundary)’ in an N-dimensional space(N — the number of features) that distinctly classifies the data points. If the data is not linearly separable in the original, or input, space then we apply transformations to the data, which map the data from the original space into a higher dimensional feature space. The goal is that after the transformation to the higher dimensional space, the classes are now linearly separable in this higher dimensional feature space.</p>

<p>We have used SMO to optimize the above equation using John Platt’s paper. 
We are solving for the alpha values first, keeping one of them fixed and iterating over the second. Then we calculate w and b values. We are using KKT conditions and constraints mentioned in the John Platt’s paper for converging conditions. In our project we have used 2 convergence conditions explained in the below steps:
In the project we first iterated through C values 1,10,100 and 1000 and checked the high F1 score range and found that the C values in the range of 100 are getting better F1 score for epsilon value 0.00001 
We are using Radial Basis Function  as our kernel using below function, we also have trained model using quadratic function but we RBF performs better.</p>

<p>We used Max iterations=1000 to train our model.
For Every C We are choosing the best F1 score values of the Validation dataset, training dataset and plotting it against the iterations to see if the model is learning correctly and there is no overfitting. And marking the safe max iteration which could also be used as the convergence condition.
As another convergence condition, We used the norm function to get the difference between old alphas and new alphas and compared it with the epsilon which is our misclassification allowance, and if it is less than the allowance the model will converge.</p>

<p><img src="/images/Projects/group_7/SVM1.webp" alt="image" /></p>

<p><br />
 </p>

<p><strong>F1 Score graphs for training data and test data were plotted as below:</strong></p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Classical ML Model</th>
      <th style="text-align: center">PCA Reduced Data</th>
      <th style="text-align: right">Autoencoder Reduced Data</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Logistic Regression</td>
      <td style="text-align: center"><img src="/images/Projects/group_7/LR2.webp" alt="image" /></td>
      <td style="text-align: right"><img src="/images/Projects/group_7/LR3.webp" alt="image" /></td>
    </tr>
    <tr>
      <td style="text-align: left">KNN</td>
      <td style="text-align: center"><img src="/images/Projects/group_7/KNN2.webp" alt="image" /></td>
      <td style="text-align: right"><img src="/images/Projects/group_7/KNN3.webp" alt="image" /></td>
    </tr>
    <tr>
      <td style="text-align: left">SVM</td>
      <td style="text-align: center"><img src="/images/Projects/group_7/SVM2.webp" alt="image" /></td>
      <td style="text-align: right"><img src="/images/Projects/group_7/SVM3.webp" alt="image" /></td>
    </tr>
  </tbody>
</table>

<h4 id="cnn">CNN</h4>

<p>Convolutional neural networks contain many convolutional layers stacked on top of each other, each one capable of recognizing more sophisticated shapes. With three or four convolutional layers it is possible to recognize handwritten digits and with 25 layers it is possible to distinguish human faces. The usage of convolutional layers in a convolutional neural network mirrors the structure of the human visual cortex, where a series of layers process an incoming image and identify progressively more complex features.</p>

<p><img src="/images/Projects/group_7/CNN1gif.gif" alt="image" /></p>

<p>Before implementing CNN, some images were flipped, rotated or cropped while feeding to CNN model to avoid overfitting.</p>

<p>While implementing CNN, we have used 4 convolution layers, 4 max pooling layers, 2 fully connected layers and an output layer. In each convolution layer we picked kernel size as 3 and stride 1 while in max pooling layers we picked both kernel size and stide as 3. We have applied ReLU activation function to all convolution layers. You can see in the following CNN architecture image, how 240 * 240 image with single channel was converted to 2 * 2 image with 512 channels, which is then flattened into 2048 neurons of a fully connected neural network.</p>

<p>CNN Architecture:</p>

<p><img src="/images/Projects/group_7/CNN2.webp" alt="image" /></p>

<p>Cross entropy loss vs epochs:</p>

<p><img src="/images/Projects/group_7/CNN3.webp" alt="image" /></p>

<p>F1 score vs epochs:</p>

<p><img src="/images/Projects/group_7/CNN4.webp" alt="image" /></p>

<h2 id="results">Results</h2>

<p>F1 score was used as the performance metrics as the data was imbalanced and there is a serious downside to predicting false negatives in such cases.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">ML Model</th>
      <th style="text-align: center">PCA Reduced Data</th>
      <th style="text-align: right">Autoencoder Reduced Data</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Logistic Regression</td>
      <td style="text-align: center">0.8355</td>
      <td style="text-align: right">0.9411</td>
    </tr>
    <tr>
      <td style="text-align: left">KNN</td>
      <td style="text-align: center">0.8437</td>
      <td style="text-align: right">0.8435</td>
    </tr>
    <tr>
      <td style="text-align: left">SVM</td>
      <td style="text-align: center">0.835</td>
      <td style="text-align: right">0.825</td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th style="text-align: left">ML Model</th>
      <th style="text-align: right">F1 Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">CNN</td>
      <td style="text-align: right">0.8816</td>
    </tr>
  </tbody>
</table>



		</article>

	</div>

</section>

		</div>

	</div>


	<footer class="footer">

	<div class="wrap">

		<p class="footer__text"></p>

		<div class="footer__copyright">
			<span>© 2023 ML with Ramin</span>
			<a href="https://jekyllthemes.io" target="_blank">Jekyll Themes</a>
		</div>

		<ul class="socials">
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	<li class="socials__item">
		<a href="https://medium.com/@mohammadi.r" target="_blank" class="socials__item__link" title="Medium">
			<i class="fab fa-medium" aria-hidden="true"></i>
		</a>
	</li>
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	<li class="socials__item">
		<a href="https://www.linkedin.com/in/ramin-mohammadi-ml/" target="_blank" class="socials__item__link" title="Linkedin">
			<i class="fab fa-linkedin" aria-hidden="true"></i>
		</a>
	</li>
	
	
</ul>

	</div>

</footer>


	<!-- Javascript Assets -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script src="/js/plugins-min.js"></script>
	<script src="/js/personal-min.js"></script>

	
	<!-- Extra Footer JS Code -->
	
	


</body>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: {
      inlineMath: [ ['$', '$'], ["\\(", "\\)"] ],
      displayMath: [ ['$$', '$$'], ["\\[", "\\]"] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});
</script>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>


</html>